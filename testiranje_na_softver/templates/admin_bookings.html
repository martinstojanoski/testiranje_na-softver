{% extends "base.html" %}
{% block title %}Registered Guests{% endblock %}

{% block content %}

{% with messages = get_flashed_messages(with_categories=True) %}
    {% if messages %}
        {% for category, msg in messages %}
            <div class="flash {{ category }}">{{ msg }}</div>
        {% endfor %}
    {% endif %}
{% endwith %}

<style>
.delete-btn {
    background-color: #8b1e1e;
    border: none;
    color: #fff;
    padding: 6px 12px;
    border-radius: 8px;
    cursor: pointer;
    font-size: 13px;
    transition: 0.3s;
}
.delete-btn:hover {
    background-color: #ff4d4d;
}

body {
    background-color: #121212;
    color: #ffffff;
    font-family: Arial, sans-serif;
}

.admin-container {
    max-width: 1100px;
    margin: 60px auto;
    background-color: #1e1e1e;
    padding: 35px;
    border-radius: 20px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.7);
}

h2 {
    text-align: center;
    margin-bottom: 30px;
    font-size: 28px;
}

table {
    width: 100%;
    border-collapse: collapse;
}

thead {
    background-color: #2a2a2a;
}

th, td {
    padding: 14px;
    text-align: center;
    border-bottom: 1px solid #333;
}

tbody tr:hover {
    background-color: #2f2f2f;
}

.badge {
    padding: 6px 12px;
    border-radius: 20px;
    font-size: 13px;
    font-weight: bold;
}

.badge-checkin {
    background-color: #6200ea;
}

.badge-checkout {
    background-color: #b00020;
    color: #ffb4b4;
}

.badge-created {
    background-color: #1e5f2b;
    color: #4dff8b;
}

.back-link {
    margin-top: 25px;
    text-align: center;
}
.back-link a {
    color: #bb86fc;
    text-decoration: none;
}
</style>

<div class="admin-container">
    <h2>Registered Guests</h2>

    {% if bookings %}
    <table>
        <thead>
    <tr>
        <th>ID</th>
        <th>Guest</th>
        <th>Email</th>
        <th>Phone</th>
        <th>Check-In Date</th>
        <th>Check-Out Date</th>
        <th>Created</th>
        <th>Actions</th>
    </tr>
</thead>
        

<tbody>
    {% for b in bookings %}
    <tr>
        <td>{{ b.id }}</td>
        <td>{{ b.first_name }} {{ b.last_name }}</td>
        <td>{{ b.email }}</td>
        <td>{{ b.phone }}</td>

        <td>
            <span class="badge badge-checkin">
                {{ b.checkin_date }}
            </span>
        </td>

        <td>
            <span class="badge badge-checkout">
                {{ b.checkout_date }}
            </span>
        </td>

        <td>
            <span class="badge badge-created">
                {{ b.created_at }}
            </span>
        </td>

        <td style="display:flex; gap:8px; justify-content:center;">
    <!-- EDIT -->
    <a href="{{ url_for('edit_booking', booking_id=b.id) }}"
       style="
        background:#3f51b5;
        color:white;
        padding:6px 12px;
        border-radius:8px;
        font-size:13px;
        text-decoration:none;
       ">
        Edit
    </a>

    <!-- DELETE -->
    <form method="POST"
          action="{{ url_for('delete_booking', booking_id=b.id) }}"
          onsubmit="return confirm('Are you sure you want to delete this booking?');">
        <button type="submit" class="delete-btn">Delete</button>
    </form>
</td>
    </tr>
    {% endfor %}
</tbody>

    </table>
    {% else %}
        <p style="text-align:center;">No registered guests yet.</p>
    {% endif %}

    <div class="back-link">
        <a href="{{ url_for('booking') }}">‚Üê Back to Admin Panel</a>
    </div>
</div>

{% endblock %}
