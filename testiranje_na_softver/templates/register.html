{% extends "base.html" %}
{% block title %}Register{% endblock %}
{% block content %}
<style>
    body { background-color:#121212; color:#ffffff; font-family:'Arial', sans-serif; }
    .register-container {
        max-width: 440px;
        margin: 70px auto;
        background-color: #1e1e1e;
        padding: 35px;
        border-radius: 18px;
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.55);
        animation: fadeIn 0.5s ease-out;
    }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0px); } }
    h2 { text-align: center; margin-bottom: 25px; color: #f5f5f5; font-size: 28px; }
    label { display:block; margin-bottom:6px; font-weight:bold; color:#e0e0e0; }
    .input-group { position:relative; margin-bottom:16px; }
    .input-group input {
        width:100%; padding:12px 45px 12px 15px;
        border:none; border-radius:10px;
        background-color:#2a2a2a; color:#fff;
        font-size:15px; transition:all .25s ease;
    }
    .input-group input:focus { outline:none; background-color:#333; box-shadow:0 0 6px #8a2be2; }
    .input-group span {
        position:absolute; right:12px; top:50%;
        transform:translateY(-50%);
        color:#c3a6ff; font-size:18px; user-select:none;
    }

    .strength-bar { height:6px; border-radius:4px; background-color:#333; margin-bottom:6px; overflow:hidden; }
    .strength-bar div { height:100%; width:0%; transition:.3s; }
    .weak { background-color:#ff4b4b; }
    .medium { background-color:#ffb300; }
    .strong { background-color:#00e676; }
    .strength-text { font-size:13px; color:#ccc; margin-bottom:16px; }

    button {
        width:100%; padding:13px;
        border:none; border-radius:10px;
        background: linear-gradient(135deg, #7b2fff, #5f12d8);
        color:#fff; font-size:17px; cursor:pointer;
        transition:.25s ease; font-weight:bold; letter-spacing:.5px; margin-top:10px;
    }
    button:hover { background: linear-gradient(135deg, #9155ff, #6b22ff); transform: translateY(-2px); }

    .login-link { text-align:center; margin-top:20px; font-size:15px; color:#c7c7c7; }
    .login-link a { color:#bb86fc; text-decoration:none; font-weight:bold; }
    .login-link a:hover { text-decoration:underline; }
</style>

<div class="register-container">
    <h2>Create Account</h2>

    <!-- ‚úÖ Flash messages (use base.html styling: flash success/error/info) -->
    {% with messages = get_flashed_messages(with_categories=True) %}
        {% if messages %}
            {% for category, msg in messages %}
                <div class="flash {{ category }}">{{ msg }}</div>
            {% endfor %}
        {% endif %}
    {% endwith %}

    <form method="POST" id="registerForm">
        <label>First Name</label>
        <div class="input-group">
            <input type="text" name="first_name" placeholder="Enter first name" required>
            <span>üßë</span>
        </div>

        <label>Last Name</label>
        <div class="input-group">
            <input type="text" name="last_name" placeholder="Enter last name" required>
            <span>üßë</span>
        </div>

        <label>Username</label>
        <div class="input-group">
            <input type="text" name="username" pattern="[A-Za-z]+" placeholder="Enter username" required>
            <span>üë§</span>
        </div>

        <label>Email</label>
        <div class="input-group">
            <input type="email" name="email" placeholder="example@mail.com" required>
            <span>üìß</span>
        </div>

        <label>Phone Number</label>
        <div class="input-group">
            <input type="tel" name="phone" placeholder="+389..." required>
            <span>üìû</span>
        </div>

        <label>Password</label>
        <div class="input-group">
            <input type="password" id="password" name="password" required>
            <span onclick="togglePassword('password')" style="cursor:pointer;">üëÅÔ∏è</span>
        </div>

        <label>Confirm Password</label>
        <div class="input-group">
            <input type="password" id="confirm_password" name="confirm_password" required>
            <span onclick="togglePassword('confirm_password')" style="cursor:pointer;">üëÅÔ∏è</span>
        </div>

        <div class="strength-bar">
            <div id="strengthBar"></div>
        </div>
        <div class="strength-text" id="strengthText">Password strength</div>

        <button type="submit">Register</button>
    </form>

    <div class="login-link">
        Already have an account? <a href="{{ url_for('login') }}">Login</a>
    </div>
</div>

<script>
    function togglePassword(id) {
        const el = document.getElementById(id);
        el.type = el.type === "password" ? "text" : "password";
    }

    function checkStrength(password) {
        const bar = document.getElementById("strengthBar");
        const text = document.getElementById("strengthText");

        let strength = 0;
        if (password.length >= 8) strength++;
        if (/[A-Z]/.test(password)) strength++;
        if (/[0-9]/.test(password)) strength++;
        if (/[^A-Za-z0-9]/.test(password)) strength++;

        bar.className = "";
        bar.style.width = "0%";

        if (strength <= 1) {
            bar.style.width = "33%";
            bar.classList.add("weak");
            text.textContent = "Weak password";
        } else if (strength <= 3) {
            bar.style.width = "66%";
            bar.classList.add("medium");
            text.textContent = "Medium strength";
        } else {
            bar.style.width = "100%";
            bar.classList.add("strong");
            text.textContent = "Strong password";
        }
    }

    document.getElementById("password").addEventListener("input", function () {
        checkStrength(this.value);
    });

    document.getElementById("registerForm").addEventListener("submit", function(e) {
        const p1 = document.getElementById("password").value;
        const p2 = document.getElementById("confirm_password").value;

        if (p1 !== p2) {
            alert("‚ùå Passwords do not match!");
            e.preventDefault();
        }
    });
</script>
{% endblock %}
